#include <carvig.h>

int main(int argc, char **argv)
{
    double A[18]={
            1,3,3,
            2,4,7,
            5,1,8,
            8,2,9,
            12,7,11,
            1,4,2
    };
    double a[30] = {
            8.79,  6.11, -9.15,  9.57, -3.49,  9.84,
            9.93,  6.91, -7.93,  1.64,  4.02,  0.15,
            9.83,  5.04,  4.86,  8.83,  9.80, -8.99,
            5.45, -0.27,  4.85,  0.74, 10.00, -6.02,
            3.16,  7.98,  3.01,  5.80,  4.27, -5.31
    };
    double c[3*8]={
            -130.805270,   -86.798313 , -143.180392,   -94.766703 , -157.398170 , -103.849917  ,-173.704949 , -114.220778  ,
            97.258402  ,-101.026913 ,  106.363075  ,-111.514693  , 116.812459  ,-123.543031   ,128.778266  ,-137.354776   ,
            27.748390  , -17.842777,    31.012361  , -19.011541 ,   34.616330  , -20.303463  ,  38.605765  , -21.772302
    };
    double N[18]; int p,q;
    double Na[30]; int pa,qa;
    double at[30],ct[3*8];

    matt(a,6,5,at);
    matt(c,3,8,ct);

    null(A,3,6,N,&p,&q);

    null(at,5,6,Na,&pa,&qa);

    tracemat(3,at,5,6,12,6);

    tracemat(3,N,p,q,12,6);
    tracemat(3,Na,pa,qa,12,6);

    null(ct,3,8,Na,&pa,&qa);
    tracemat(3,Na,pa,qa,12,6);

    double Hf[10*3]={
            -196.225045 ,   49.375925  ,-206.430979 ,   50.651307 , -217.329912 ,   52.009658  ,-228.823314 ,   53.515199 , -240.789243 ,   55.241698 ,
            -120.917014 , -164.755180 , -124.550536 , -171.007699 , -128.023542 , -177.523698 , -131.200929 , -184.244658 , -133.854410,  -191.088755 ,
            39.975820  ,-135.289648  ,  38.696905  ,-142.105460   , 37.075107  ,-149.459517 ,   35.057565 , -157.378489  ,  32.621421 , -165.862737
    };
    double Nhf[7*10]={
            0.027955   , -0.428789   ,  0.041979   , -0.410849  ,   0.058327  ,  -0.387176   ,  0.077239  ,
            -0.441459  ,  -0.024134  ,  -0.441311  ,   0.028443 ,   -0.439302 ,    0.090190  ,  -0.435246 ,
            -0.102237  ,  -0.014577  ,   0.010753  ,   0.315299 ,    0.141467 ,    0.698879  ,   0.290616 ,
            0.858743  ,   0.023290   , -0.133763   ,  0.062395  ,  -0.124557  ,   0.107841   , -0.113545  ,
            -0.005165  ,   0.852403  ,  -0.011528  ,  -0.171152 ,   -0.018742 ,   -0.197539  ,  -0.026786 ,
            -0.138029  ,   0.012734  ,   0.859251  ,   0.022243 ,   -0.143324 ,    0.033361  ,  -0.145721 ,
            0.020722   , -0.186387   , -0.015573   ,  0.701006  ,  -0.057381  ,  -0.428644   , -0.104850  ,
            -0.133721  ,   0.000567  ,  -0.148244  ,  -0.024194 ,    0.835562 ,   -0.052829  ,  -0.182335 ,
            0.050996   , -0.230510   , -0.020051   , -0.446496  ,  -0.102025  ,   0.303971   , -0.195271  ,
            -0.128256  ,  -0.013223 ,   -0.156231  ,  -0.077111 ,   -0.187949 ,   -0.151130  ,   0.776481
    };
    double K[10*10],NHft[10*7],Hft[10*3];

    matt(Hf,3,10,Hft);
    matt(Nhf,10,7,NHft);

    matmul("NN",3,7,10,1.0,Hft,NHft,0.0,K);

    tracemat(3,K,3,7,12,6);

    return 0;
}